## 概览
- 目标：在现有项目中新增一个简化的管理员端，涵盖管理员登录、商品审核、用户管理、订单统计与分类管理，完全兼容当前数据库结构，无需改表。
- 原则：后端在每个 `/api/admin/*` 接口内做 `role=ADMIN` 校验；前端独立 `/admin` 路由与页面，复用现有登录与 axios。

## 后端接口（/api/admin/*）
- 认证与鉴权：沿用 `JWT`；在控制器方法中用 `request.getAttribute('userId')` 查询当前用户并校验 `user.role==='ADMIN'`，非法返回 403。
- 商品审核：
  - `GET /api/admin/products/pending`：分页查询 `product.status='PENDING'`。
  - `POST /api/admin/products/{id}/approve`：将 `status='AVAILABLE'`。
  - `POST /api/admin/products/{id}/reject`：为简化直接删除该商品（无 `REJECTED` 状态）。
- 用户管理：
  - `GET /api/admin/users`：分页/搜索（用户名/昵称）。
  - `PATCH /api/admin/users/{id}/role`：切换角色（`USER`↔`ADMIN`）。
- 分类管理：
  - `GET /api/admin/categories`：列表。
  - `POST /api/admin/categories`：新增分类（重名校验）。
  - `DELETE /api/admin/categories/{id}`：删除分类（若被 `product.category_id` 引用则拒绝）。
- 订单统计：
  - `GET /api/admin/stats/orders?from=YYYY-MM-DD&to=YYYY-MM-DD&granularity=day`：返回近 7 天按日统计（订单数与销售额），基于 `orders.status IN ('PAID','SHIPPED','RECEIVED')` 聚合。

## 前端管理端（/admin）
- 路由：`/admin/login`、`/admin/products`、`/admin/users`、`/admin/categories`、`/admin/stats`。
- 登录：复用现有 `POST /api/auth/login`，登录成功后检查返回的 `user.role==='ADMIN'`，否则提示无权限。
- 守卫：进入 `/admin/*` 时要求本地 `token` 存在；各页面首次加载时调用一个轻量的 admin 接口以确认 `role=ADMIN`。
- 页面：
  - 商品审核页：表格列出 `PENDING` 商品，支持通过/驳回。
  - 用户管理页：列表与角色切换（按钮）。
  - 分类管理页：列表、新增、删除（二次确认）。
  - 订单统计页：使用 `echarts` 折线图展示近 7 天订单数量与销售额。

## 数据初始化
- 管理员账号：
  - 方案 A：先用普通账号登录，再在“用户管理”页把该账号切换为 `ADMIN`。
  - 方案 B：用 SQL 插入一条 `role='ADMIN'` 的用户（密码用 BCrypt 加密），与现有登录完全兼容。

## 实施步骤（4 步）
1) 新增后端 `/api/admin/*` 控制器与服务，接口内做角色校验并返回统一 `Result`。
2) 准备管理员账号（A/B 任选其一）。
3) 前端新增 `/admin` 路由与 4 个页面，复用 axios 与 token；完成基本交互。
4) 联调与验收：审核流程、分类删除校验、近 7 天统计图表与权限拦截。

## 验收与验证
- 后端：用 Postman 验证管理员与非管理员访问差异、分页与聚合。
- 前端：本地运行，验证登录守卫、页面功能与图表渲染；不影响现有用户端。

## 说明
- 全部接口与页面均基于现有表结构：`user.role`、`product.status`、`orders`、`category`，不需要数据库修改。